(function(e){function t(t){for(var r,s,o=t[0],c=t[1],u=t[2],d=0,f=[];d<o.length;d++)s=o[d],a[s]&&f.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0dc3":function(e,t,n){"use strict";var r=n("5f9b"),a=n.n(r);a.a},"14dd":function(e,t,n){},"2a0f":function(e,t,n){"use strict";var r=n("14dd"),a=n.n(r);a.a},3460:function(e,t,n){"use strict";var r=n("a10f"),a=n.n(r);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",{staticClass:"label"},[e._v("NLP-sovellus")]),n("toolbar",{attrs:{"current-comp":e.currentComp}}),n("div",{staticClass:"container"},[n(e.currentComp,{tag:"component"})],1)],1)},i=[],s=n("a322"),o=(n("20d6"),n("7f7f"),n("55dd"),n("2f62")),c=n("0e44"),u=n("a78e"),l=n("b054"),d=n.n(l),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{staticClass:"switch summarize",attrs:{disabled:"summarize-wizard"===e.currentComp},on:{click:function(t){e.switchComponent("summarize-wizard")}}},[e._v("Lauseiden valinta")]),n("button",{staticClass:"switch ner",attrs:{disabled:"named-entity-recognition"===e.currentComp},on:{click:function(t){e.switchComponent("named-entity-recognition")}}},[e._v("Henkilötietojen piilottaminen")])])},m=[],h={props:{currentComp:{type:String,required:!0}},methods:{switchComponent:function(e){q.$emit("switchComp",e)}}},p=h,v=(n("a66f"),n("2877")),_=Object(v["a"])(p,f,m,!1,null,"a8ee1186",null),b=_.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-wizard",{attrs:{"start-index":0,title:"Henkilötietojen piilottaminen",subtitle:"Korvaa erisnimet ja henkilötunnukset tekstistä",color:"#e67e22"},on:{"on-complete":e.onComplete,"on-error":e.handleErrorMessage,"on-loading":e.setLoading,"on-validate":e.fetchNERs}},[n("tab-content",{attrs:{title:"Tiedosto","before-change":e.validateNerFile,icon:"ti-user"}},[n("p",[e._v(" Anna tiedosto, joka sisältää korvattavan tekstin. ")]),n("input",{attrs:{id:"ner_file",type:"file"},on:{change:function(t){e.setNerFile(t)}}}),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"checked"}],attrs:{type:"checkbox",id:"detect_hetu"},domProps:{checked:Array.isArray(e.checked)?e._i(e.checked,null)>-1:e.checked},on:{change:function(t){var n=e.checked,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=null,s=e._i(n,i);r.checked?s<0&&(e.checked=n.concat([i])):s>-1&&(e.checked=n.slice(0,s).concat(n.slice(s+1)))}else e.checked=a}}}),n("label",{attrs:{for:"detect_hetu"}},[e._v("Hae samalla HETUT (muodossa 010101-1234) korvattavaksi. ")])])]),n("tab-content",{attrs:{title:"Valitse korvattavat sanat",icon:"ti-settings","before-change":e.validateChosenNERs}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.$store.state.ners_fetched,expression:"!$store.state.ners_fetched"}]},[e._v(" Loading ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.ners_fetched,expression:"$store.state.ners_fetched"}]},[n("fieldset",[n("legend",[e._v("Valitse korvattavat sanat")]),n("div",{staticClass:"ner-row"},[n("input",{attrs:{type:"checkbox",id:"select_all",value:"select_all",name:"feature"},on:{change:function(t){e.selectAllNERs(t)}}}),n("label",{attrs:{for:"select_all"}},[n("b",[e._v("Valitse kaikki sanat")])])]),n("div",{staticClass:"ner-container"},e._l(this.$store.state.nernames,function(t,r){return n("div",{key:r,staticClass:"ner-row"},[n("input",{attrs:{type:"checkbox",id:t.name,name:"feature"},domProps:{value:t.name},on:{change:function(t){e.addNERToBeSubstituted(t)}}}),n("label",{attrs:{for:t.name}},[e._v(e._s(t.name))]),n("input",{attrs:{type:"text",id:t.name+"-substitute",placeholder:"Korvike"},domProps:{value:t.substitute},on:{change:function(t){e.changeSubstitute(t)}}})])}))])])]),n("tab-content",{attrs:{title:"Syötetiedoston muoto",icon:"ti-check","before-change":e.replaceWords}},[n("h3",[e._v("Korvataan sanat ")]),n("div",{staticClass:"substitute-pairs"},e._l(this.$store.state.nernames.filter(function(e){return e.selected}),function(t,r){return n("span",{key:r,staticClass:"sub-pair"},[e._v(e._s(t.name)+" => "+e._s(t.substitute)+" ")])})),n("br"),n("br"),e._v("\n      Missä muodossa haluat tiedoston ulos?\n      "),n("select",{attrs:{id:"returnType"},on:{change:function(t){e.changeNerReturnType(t)}}},[n("option",{attrs:{value:"docx"}},[e._v("Docx (word) tiedosto ")]),n("option",{attrs:{value:"txt"}},[e._v("Teksi (.txt) tiedosto ")])])]),e.loadingWizard?n("div",{staticClass:"loader"}):e._e(),e.errorMsg?n("div",[n("span",{staticClass:"error"},[e._v(e._s(e.errorMsg))])]):e._e()],1)},k=[],y=(n("7514"),n("2ee4")),E=n.n(y),T=(n("da93"),n("2440"));n("28a5");function N(e){var t="ABCDEFGHIJKLMNOPQRSTUWXYZ".split(""),n=e>0?Math.ceil(e/t.length):1,r=e%t.length,a=t[r];return Array(n+1).join(a)}function C(e,t){var n=e.state.nernames.filter(function(e){return e.selected}),r=n.length,a=N(r),i={name:t,substitute:a};e.commit("TOGGLE_SUBSTITION",t),""==e.state.nernames.find(function(e){return e.name==t}).substitute&&e.commit("CHANGE_SUBSTITION",i)}r["a"].use(E.a);var O,S={data:function(){return{loadingWizard:!1,errorMsg:null,count:0}},methods:{setNerFile:function(e){this.$store.commit("SET_NER_FILE",e.currentTarget.files[0])},onComplete:function(){alert("Tässä menee pieni hetki.")},setLoading:function(e){this.loadingWizard=e},handleErrorMessage:function(e){this.errorMsg=e},validateChosenNERs:function(){var e=this.$store.state;return new Promise(function(t,n){0==e.nernames.length&&n("Henkilötiedot eivät ole vielä latautuneet tai yhtäkään ei löytynyt."),0==e.nernames.filter(function(e){return e.selected}).length&&n("Valitse ainakin yksi henkilötieto korvattavaksi.");var r=e.nernames.filter(function(e){return e.selected&&(null==e.substitute||""==e.substitute)});r.length>0&&n("Anna korvikkeet henkilötiedoille: "+r.map(function(e){return e.name}).join(", ")+" "),t(!0)})},validateNerFile:function(){var e=this.$store.state.nerFile;return new Promise(function(t,n){var r=!1,a=[".pdf",".docx",".txt"];if(e){for(var i=0;i<a.length;i++)-1!==e.name.indexOf(a[i])&&(r=!0);r?t(!0):n("Tiedosto ei kelpaa, anna yksi seuraavista "+a)}else n("Anna tiedosto.")})},fetchNERs:function(){var e=this,t=this.$store.state.nerFile,n=this.$store.state.apiurl,r=this.$store.state.nerSearchPersonid,a=n+"/entities/directory";a+="?return_type=json&",a+="person_ids="+r;var i=new FormData;i.append("file-0",t),fetch(a,{method:"POST",body:i}).then(function(e){return e.json()}).then(function(t){for(var n=t.names,r=n.filenames.map(function(e){return n[e]})[0],a=0;a<r.length;a++){var i=0!=e.$store.state.nernames.length&&e.$store.state.nernames.some(function(e){return e.name==r[a]});i||e.$store.commit("ADD_NER_NAME",{name:r[a],selected:!1,substitute:""})}}).catch(function(e){error.log(e)})},addNERToBeSubstituted:function(e){var t=e.currentTarget.value;C(this.$store,t)},selectAllNERs:function(e){var t=e.currentTarget.checked,n=document.getElementsByName(e.currentTarget.name);for(var r in n){var a=n[r];if(a instanceof HTMLInputElement){var i=a.checked!==t;a.checked=t,"select_all"!=a.value&&i&&C(this.$store,a.value)}}},replaceWords:function(){var e=this.$store.state.nernames.filter(function(e){return e.selected}),t=e.map(function(e){return e.name}),n=e.map(function(e){return e.substitute}),r=this.$store.state.nerFile,a=this.$store.state.apiurl,i=this.$store.state.nerReturnType,s=a+"/entities/replace",o=new FormData;o.append("file-0",r),s+="?return_type="+i+"&",s+="nerlist="+encodeURIComponent(JSON.stringify(t))+"&",s+="substitutes="+encodeURIComponent(JSON.stringify(n)),fetch(s,{method:"POST",body:o}).then(function(e){return e.blob()}).then(function(e){Object(T["saveAs"])(e)}).catch(function(e){error.log(e)})},changeSubstitute:function(e){var t=e.currentTarget.id,n=t.substring(0,t.length-11),r=e.currentTarget.value;this.$store.commit("CHANGE_SUBSTITION",{name:n,substitute:r})},changeNerReturnType:function(e){var t=e.currentTarget.options[e.currentTarget.selectedIndex].value;this.$store.commit("CHANGE_NER_RETURN_TYPE",t)}},computed:{checked:{get:function(){return this.$store.state.nerSearchPersonid},set:function(e){this.$store.commit("CHANGE_NER_TOGGLE_SEARCH_PERSONID")}}}},w=S,x=(n("2a0f"),Object(v["a"])(w,g,k,!1,null,"69462af6",null)),R=x.exports,$=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},j=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",{staticClass:"label"},[e._v("Lauseiden valinta")]),n("h1",[e._v("Tulossa pian")])])}],A={data:function(){return{notes:[{id:1,text:"Marco"},{id:2,text:"Polo"}]}}},P=A,I=(n("0dc3"),Object(v["a"])(P,$,j,!1,null,"41d1bdf3",null)),M=I.exports,G="SET_NER_FILE",H="ADD_NER_NAME",L="TOGGLE_SUBSTITION",F="CHANGE_SUBSTITION",z="CHANGE_NER_RETURN_TYPE",U="CHANGE_NER_TOGGLE_SEARCH_PERSONID";function D(){var e=new XMLHttpRequest;e.open("GET","/config",!1),e.send(null);var t=JSON.parse(e.responseText);return t.apiurl}var B=D();r["a"].use(o["a"]);var J=new o["a"].Store({state:{nerFile:null,nernames:[],ners_fetched:!1,apiurl:B,nerReturnType:"docx",nerSearchPersonid:!0},mutations:(O={},Object(s["a"])(O,G,function(e,t){e.nerFile=t,e.ners_fetched=!1,e.nernames=[]}),Object(s["a"])(O,H,function(e,t){e.nernames.push(t),e.nernames=e.nernames.sort(function(e,t){return e.name>t.name}),e.ners_fetched=!0}),Object(s["a"])(O,L,function(e,t){var n=e.nernames.findIndex(function(e){return e.name==t});e.nernames[n].selected=!e.nernames[n].selected}),Object(s["a"])(O,F,function(e,t){var n=e.nernames.findIndex(function(e){return e.name==t.name});e.nernames[n].substitute=t.substitute}),Object(s["a"])(O,z,function(e,t){e.nerReturnType=t}),Object(s["a"])(O,U,function(e){e.nerSearchPersonid=!e.nerSearchPersonid}),O),plugins:[Object(c["a"])({storage:{getItem:function(e){return u["get"](e)},setItem:function(e,t){return u["set"](e,t,{expires:3,secure:!0})},removeItem:function(e){return u["remove"](e)}}}),d()()]}),W={el:"#app",store:J,data:function(){return{currentComp:"named-entity-recognition"}},created:function(){var e=this;q.$on("switchComp",function(t){e.currentComp=t})},components:{toolbar:b,"named-entity-recognition":R,"summarize-wizard":M}},K=W,V=(n("3460"),Object(v["a"])(K,a,i,!1,null,"570a7b09",null)),Y=V.exports;n.d(t,"bus",function(){return q}),r["a"].config.productionTip=!1;var q=new r["a"];new r["a"](Y).$mount("#app")},"5f9b":function(e,t,n){},a10f:function(e,t,n){},a66f:function(e,t,n){"use strict";var r=n("e02f"),a=n.n(r);a.a},e02f:function(e,t,n){}});
//# sourceMappingURL=app.8803413a.js.map